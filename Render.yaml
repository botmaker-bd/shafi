# render.yaml
services:
  - type: web
    name: telegram-bot-platform
    env: node
    plan: free
    buildCommand: |
      npm install
      npm audit fix --force
      chmod +x scripts/setup-python-env.sh
      ./scripts/setup-python-env.sh
    startCommand: npm run render-start
    envVars:
      - key: NODE_ENV
        value: production
      - key: USE_WEBHOOK
        value: true
      - key: BASE_URL
        fromService:
          type: web
          name: telegram-bot-platform
          property: url
      - key: SUPABASE_URL
        value: https://tyoaazgsoqvubgfychmd.supabase.co
      - key: SUPABASE_KEY
        value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR5b2Fhemdzb3F2dWJnZnljaG1kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3NTE0NDQsImV4cCI6MjA3ODMyNzQ0NH0.czWc-rOitmnn31iAvgTEvZj7bW-aJ2ysFymoWJ8UZCc
      - key: PYTHON_PATH
        value: python3
    healthCheckPath: /api/health
    autoDeploy: true